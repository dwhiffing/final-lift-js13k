<!DOCTYPE html><html lang="en"><head><meta name="viewport" content="width=device-width,initial-scale=1"><title>Elevator</title></head><body style="margin:0;background:#111;color:#666;font-family:sans-serif;height:100vh;display:flex;flex-direction:column;justify-content:center;align-items:center"><canvas style="background:#000;border-radius:16px"></canvas><a style="cursor:pointer;padding-top:8px">mute</a><script>/**
 * @preserve
 * Kontra.js v10.0.2
 */
function t(t,e,i){return Math.min(Math.max(t,i),e)}let e=()=>{};function i(t,e){let{x:i,y:n,width:s,height:o}=e;e.anchor&&(i-=s*e.anchor.x,n-=o*e.anchor.y);let h=t.x-Math.max(i,Math.min(t.x,i+s)),r=t.y-Math.max(n,Math.min(t.y,n+o));return h*h+r*r<t.radius*t.radius}let n,s,o={};function h(t,e){o[t]=o[t]||[],o[t].push(e)}function r(t,...e){(o[t]||[]).map((t=>t(...e)))}let a={get:(t,i)=>"_proxy"==i||e};function c(){return n}function l(){return s}class d{constructor(t=0,e=0,i={}){null!=t.x?(this.x=t.x,this.y=t.y):(this.x=t,this.y=e)}set(t){this.x=t.x,this.y=t.y}add(t){return new d(this.x+t.x,this.y+t.y,this)}}class u extends class{constructor(t){return this.init(t)}init(t={}){this.position=function(){return new d(...arguments)}(),Object.assign(this,t)}update(t){this.advance(t)}advance(t){}_pc(){}}{init({width:t=0,height:e=0,context:i=l(),render:n=this.draw,update:s=this.advance,children:o=[],anchor:r={x:0,y:0},...a}={}){this._c=[],super.init({width:t,height:e,context:i,anchor:r,...a}),this._di=!0,this._uw(),this.addChild(o),this._rf=n,this._uf=s,h("init",(()=>{this.context??=l()}))}update(t){this._uf(t),this.children.map((e=>e.update&&e.update(t)))}render(){let t=this.context;t.save(),(this.x||this.y)&&t.translate(this.x,this.y);let e=this.width,i=this.height,n=-e*this.anchor.x,s=-i*this.anchor.y;(n||s)&&t.translate(n,s),this._rf(),(n||s)&&t.translate(-n,-s),this.children.map((t=>t.render&&t.render())),t.restore()}draw(){}_pc(){this._uw(),this.children.map((t=>t._pc()))}get x(){return this.position.x}get y(){return this.position.y}set x(t){this.position.x=t,this._pc()}set y(t){this.position.y=t,this._pc()}get width(){return this._w}set width(t){this._w=t,this._pc()}get height(){return this._h}set height(t){this._h=t,this._pc()}_uw(){if(!this._di)return;let{_wx:t=0,_wy:e=0}=this.parent||{};this._wx=this.x,this._wy=this.y,this._ww=this.width,this._wh=this.height,this._wx+=t,this._wy+=e}get world(){return{x:this._wx,y:this._wy,width:this._ww,height:this._wh}}set children(t){this.addChild(t)}get children(){return this._c}addChild(...t){t.flat().map((t=>{this.children.push(t),t.parent=this,t._pc=t._pc||e,t._pc()}))}}class f extends u{init({...t}={}){super.init({...t})}draw(){this.color&&(this.context.fillStyle=this.color,this.context.fillRect(0,0,this.width,this.height))}}let x=/(\d+)(\w+)/;class w extends u{init({text:t="",textAlign:e="center",anchor:i={x:0,y:.5},color:n="#fff",lineHeight:s=1,font:o=l()?.font,...r}={}){t=""+t,super.init({text:t,textAlign:e,lineHeight:s,font:o,color:n,anchor:i,...r}),this.context&&this._p(),h("init",(()=>{this.font??=l().font,this._p()}))}get width(){return this._w}set width(t){this._d=!0,this._w=t,this._fw=t}get text(){return this._t}set text(t){this._d=!0,this._t=""+t}get font(){return this._f}set font(t){this._d=!0,this._f=t,this._fs=function(t){if(!t)return{computed:0};let e=t.match(x),i=+e[1];return{size:i,unit:e[2],computed:i}}(t).computed}get lineHeight(){return this._lh}set lineHeight(t){this._d=!0,this._lh=t}render(){this._d&&this._p(),super.render()}_p(){this._s=[],this._d=!1;let t=this.context,e=[this.text];if(t.font=this.font,e=this.text.split("\n"),this._fw&&e.map((e=>{let i=e.split(" "),n=i.shift(),s=n;i.map((e=>{s+=" "+e,t.measureText(s).width>this._fw&&(this._s.push(n),s=e),n=s})),this._s.push(s)})),!this._s.length&&this.text.includes("\n")){let i=0;e.map((e=>{this._s.push(e),i=Math.max(i,t.measureText(e).width)})),this._w=this._fw||i}this._s.length||(this._s.push(this.text),this._w=this._fw||t.measureText(this.text).width),this.height=this._fs+(this._s.length-1)*this._fs*this.lineHeight,this._uw()}draw(){let t=this.textAlign,e=this.context;this._s.map(((i,n)=>{e.textBaseline="top",e.textAlign=t,e.fillStyle=this.color,e.font=this.font,e.fillText(i,0,this._fs*this.lineHeight*n)}))}}function p(){return new w(...arguments)}let g=new WeakMap,m={};function _(t){b(t,"onDown")}function y(t){b(t,"onUp")}function z(t){b(t,"onOver")}function v(t){g.get(t.target)._oo=null}function M(t,e,n){let s=function(t){let e=t._lf.length?t._lf:t._cf;for(let n=e.length-1;n>=0;n--){let s=e[n];if(s.collidesWithPointer?s.collidesWithPointer(t):i(t,s))return s}}(t);s&&s[e]&&s[e](n),m[e]&&m[e](n,s),"onOver"==e&&(s!=t._oo&&t._oo&&t._oo.onOut&&t._oo.onOut(n),t._oo=s)}function b(t,e){t.preventDefault();let i=t.target,n=g.get(i),s=i.getBoundingClientRect(),o=s.left,h=s.top;t.type.includes("touch")?(Array.from(t.touches).map((({clientX:t,clientY:e,identifier:i})=>{let s=n.touches[i];s||(s=n.touches[i]={start:{x:(t-o)/1,y:(e-h)/1}},n.touches.length++),s.changed=!1})),Array.from(t.changedTouches).map((({clientX:i,clientY:s,identifier:a})=>{let c=n.touches[a];c.changed=!0,c.x=n.x=(i-o)/1,c.y=n.y=(s-h)/1,M(n,e,t),r("touchChanged",t,n.touches),"onUp"==e&&(delete n.touches[a],n.touches.length--,n.touches.length||r("touchEnd"))}))):(n.x=(t.clientX-o)/1,n.y=(t.clientY-h)/1,M(n,e,t))}function A(t,e){let i=t[0].toUpperCase()+t.substr(1);m["on"+i]=e}function C(t){let e=t.canvas;t.clearRect(0,0,e.width,e.height)}class P extends f{constructor(t,e=!1){super({x:0,y:0,width:0,height:0,anchor:{x:0,y:0}}),this.colors=t,this.horizontal=e}onResize(t,e,i,n,s=0,o=0,h=0,r=0){this.x=t,this.y=e,this.width=i,this.height=n,this.chamferT=s,this.chamferR=o,this.chamferB=h,this.chamferL=r}draw(){const t=this.horizontal?this.width*(this.x<100?0:1):0,e=this.horizontal?this.width*(this.x>100?0:1):0,i=this.horizontal?0:this.height,n=this.context.createLinearGradient(t,0,e,i);this.colors.forEach(((t,e)=>n.addColorStop(e/this.colors.length,t))),this.context.fillStyle=n,this.context.beginPath(),this.context.moveTo(this.chamferT,-this.chamferL),this.context.lineTo(this.width-this.chamferT,-this.chamferR),this.context.lineTo(this.width-this.chamferB,this.height+this.chamferR),this.context.lineTo(this.chamferB,this.height+this.chamferL),this.context.closePath(),this.context.stroke(),this.context.fill()}}let R=[];const S=()=>{const{width:t,height:e}=c();let i=[],n="-1",s=[];const o=(t="",i="#fff")=>{h.text=t,h.color=i,h.y=.5*e},h=p({text:"",font:"28px Arial",x:t/2,y:e/2,width:190,height:200});return{nextPuzzle:(r=1,a=1)=>{0===R.length&&(R=W([k]));const c=R.shift()(r,a);i=c.options.map(String),n=Array.isArray(c.correctAnswer)?c.correctAnswer.map(String):[`${c.correctAnswer}`],o(c.text),s=c.emojiCounts&&13!=a?B(c.emojiCounts,t/2-50,.32*e):[],h.y=c.emojiCounts?.65*e:.5*e},setText:o,getCorrectAnswer:()=>n,getOptions:()=>i,render(){h.render(),s.forEach((t=>t.render()))}}},E=["ðŸŽ","ðŸŒ","ðŸ‡","ðŸ“","ðŸ‘"],k=(e=1)=>{const i=W(E).slice(0,1+Math.ceil(e/3)),n=t(6,35,4*e),s=Array.from({length:i.length},((t,e)=>e)),o=s.reduce(((t,e)=>t+e)),h=Math.floor((n-o)/i.length),r=W(s.map(((t,e)=>e+h))),a=i.reduce(((t,e,i)=>({...t,[e]:r[i]})),{}),c=Math.random()<.5,l=Object.keys(a).reduce(((t,e)=>c?a[t]>a[e]?t:e:a[t]<a[e]?t:e));return{emojiCounts:a,text:`Which are there ${c?"most":"fewest"} of?`,options:W(Object.keys(a)),correctAnswer:l}},B=(t,e,i)=>{const n=[];let s=0;const o=(7-Math.floor(Object.values(t).reduce(((t,e)=>t+e))/5))/2*26;return Object.entries(t).forEach((([t,h])=>{for(let r=0;r<h;r++)n.push(p({text:t,font:"24px Arial",x:e+s%5*26,y:o+i+26*Math.floor(s/5)})),s++})),n},T=t=>new Array(t).fill("");let D=1;const L={elevator:[.8,,123,.04,.3,.8,1,2.3,,-95,,,.06,,5.7,.2,.1,.97,.2,.38],incorrect:[.5,,412,,.09,.07,3,3.7,,10,,,,1.6,,.5,.01,.45,.08,,101],correct:[.5,,649,.01,,.13,1,1.1,,,139,.06,,,,,,.95,.03,,128],swap:[3,.1,44,.03,.04,.03,,1.4,,40,,,,,,,,.83,.02,,540],doors:[.3,.9,50,.05,.3,.3,4,1.2,1,,,,,2,,.24,.35,.4,.2,,-2150],tick:[.3,,1768,,.01,.01,,.2,14,39,,,,,.5,.3,,.31,.01],startGame:[2,,950,.02,.03,.004,4,3.3,-83,28,-44,.9,.09,,17,,.35,.67,.03,.36],click:[1.2,,342,,.09,.26,,.9,,3,,,.07,.5,,.1,,.42,.05,.15],tickUrgent:[2,,182,.02,.03,.03,1,.2,,,,,,.1,18,,.42,.72,.03],gameover:[,,387,.06,.23,.26,1,1.7,-8,,-63,.09,.04,,,.2,,.55,.16]},O=t=>{zzfx(L[t][0]||1,...L[t].slice(1))},j=t=>W(t)[0];function W(t){const e=[...t];for(var i=t.length-1;i>0;i--){var n=Math.floor(Math.random()*(i+1)),s=e[i];e[i]=e[n],e[n]=s}return e}function $(t,e,i){const n=function(t){return t<.5?2*t*t:-2*t*t+4*t-1}(i);return(1-n)*t+n*e}const H=(t,e)=>{const i=Math.floor(e/2),n=13-t,s=[...T(6-i).fill(0),...T(i).fill(1),...T(n<=6?i:0).fill(2)],o=j(s),h=t>11?0:t<9?1:.5,r=2!==o&&Math.random()>=h;let a=0;return 0===o?a=j([1,2,3]):1===o?a=j([4,5,6,7]):2===o&&(a=n),r?-1*a:a};function N(t,e){const i=t/D;let n=0,s=0,o=0;return new Promise((t=>{requestAnimationFrame((function h(r){n||(n=r);let a=0;if(window.__focused){const t=r-n-s;a=Math.min(t/(i||1),1),e?.(a)}else s+=r-o;a<1?requestAnimationFrame(h):t(0),o=r}))}))}const U=(e,i,n,s)=>((e,i,n)=>{const s=document.createElement("canvas");s.width=e,s.height=i;const o=s.getContext("2d"),h=o.getImageData(0,0,e,i),r=new ArrayBuffer(h.data.length),a=new Uint8ClampedArray(r),c=new Uint32Array(r);for(let s=0;s<i;s++)for(let o=0;o<e;o++){const h=n({x:o/(e-1)-.5,y:s/(i-1)-.5});c[s*e+o]=t(0,255,255*h.a)<<24|t(0,255,255*h.b)<<16|t(0,255,255*h.g)<<8|t(0,255,255*h.r)}return h.data.set(a),o.putImageData(h,0,0),s})(s,s,(s=>{const o=((e,i,n)=>{const s=t(0,1,(n-e)/(i-e));return s*s*(3-2*s)})(0,1.3,1-2*Math.sqrt(s.x**2+s.y**2));return{r:e,g:i,b:n,a:o*o*o}}));class X extends f{init({disabled:t=!0,...e}={}){super.init({width:15,height:15,anchor:{x:.5,y:.5},isCorrect:!1,hasColorState:!1,disabled:!0,state:0,render:function(){const t=this.width,e=this.context,i=this.focused||this.hovered,n=this.pressed||1===this.state,s=(this.state>1?5:1===this.state?3:i?2:1)*t,o=this.state<2||!this.hasColorState?[.9,.9,.8]:2===this.state?[.6,1,.6]:[1,.2,.2],h=U(...o,s);if(e.beginPath(),e.arc(t/2,t/2,t/2,0,2*Math.PI),e.fillStyle=this.disabled?"#8885":n?"#666":"#888",e.lineWidth=2,e.strokeStyle=this.disabled?"#aaa5":i?"#eee":"#aaa",e.save(),e.clip(),e.fill(),e.stroke(),e.restore(),!this.disabled){const i=(s-t)/2;e.drawImage(h,-i,-i)}},...e}),this.textNode=p({text:"",font:"7px Arial",width:5,anchor:{x:0,y:window.safari?.6:.55},context:this.context}),function(...t){t.flat().map((t=>{let e=t.context?t.context.canvas:c(),i=g.get(e);t.__r||(t.__r=t.render,t.render=function(){i._cf.push(this),this.__r()},i._o.push(t))}))}(this),this.addChild(this.textNode),this._uw(),this._p()}_p(){this.textNode._p();this.width=Math.max(15,this.width),this.height=Math.max(17,this.height),this._uw()}render(){this._d&&this._p(),this.textNode.anchor.x=!window.safari&&E.includes(this.textNode.text)?-.25:0,super.render()}onOver(){this.disabled||(this.hovered=!0,this.pressed=window.__pointerDown)}onOut(){this.hovered=!1,this.pressed=!1}onDown(){this.disabled||(this.pressed=!0)}onUp(){if(!this.disabled&&!window.__disableClick){if(0!==this.state)return;this.pressed=!1,O(this.hasColorState?this.isCorrect?"correct":"incorrect":"click"),this.state=this.isCorrect?2:3,r("press",this.textNode.text),N(1e3).then((()=>{this.state=0}))}}collidesWithPointer(t){const e=c().width/2+Q.x,i=c().height/2+Q.y,n=(t.x-e)/Q.zoom+e,s=(t.y-i)/Q.zoom+i+1.5,o=n-this.x,h=s-this.y;return Math.sqrt(o*o+h*h)<this.width/2}}const F=()=>{const t=function(){return new f(...arguments)}({color:"#000"}),e=p({color:"#ff0000",text:60..toString(),font:"12px Arial"});let i=1;const n=l();return{setDifficulty(t){i=t},onResize(i,n,s,o){t.x=i,t.y=n,t.width=s,t.height=o,e.x=i+s/2,e.y=(window.safari?n-2:n)+o/2},setText(t){e.text=t},render(){t.render(),e.render();for(let e=0;e<9;e++)n.fillStyle=e>=i?"#400":"#c00",n.beginPath(),n.arc(5.5+t.x+4.6*e,t.y+t.height-3,1,0,360),n.fill()}}},q=["#766656","#615546"],G=["#9B938B","#6A5F54","#584D3F"],I=["#372C26","#2A211B"],V=["#55493E","#3B3126"],Y=["#423528","#524131"];function J(t){t=Math.max(0,Math.min(1,t));return Math.round(255*t).toString(16).padStart(2,"0").toUpperCase()}const K=[[[.2,0,386,,,.3,1],[.2,0,386,,,.5,2]],[[[,1,6,,.03,.06,6.02,.04,.09,,18,,.03,.06,6.02,.04,18.05,,,,6.03,.06,18.02,.04,6.05,,13,,6.03,.06,18.02,.04,6.05,,2,,.03,.06,2.02,.04,.09,,14,,.03,.06,2.02,.04,14.05,,,,2.03,.06,14.02,.04,2.05,,9,,2.03,.06,14.02,.04,2.05,,],[1,-1,13,13.77,18,13.77,21,18.77,13,21.77,18,13.77,21,18.77,13,21.77,18,13.77,21,18.77,13,21.77,18,13.77,21,18.77,13,21.77,18,13.77,21,18.77,13,21.77,14,13.77,18,14.77,21,18.77,14,21.77,18,14.77,21,18.77,14,21.77,18,14.77,21,18.77,14,21.77,18,14.77,21,18.77,14,21.77,18,14.77,21,18.77,14,21.77]],[[,1,9,,.03,.06,9.02,.04,.09,,21,,.03,.06,9.02,.04,21.05,,,,9.03,.06,21.02,.04,9.05,,16,,9.03,.06,21.02,.04,9.05,,4,,.03,.06,4.02,.04,.09,,16,,.03,.06,4.02,.04,16.05,,,,4.03,.06,16.02,.04,4.05,,11,,4.03,.06,16.02,.04,4.05,,],[1,-1,13,13.77,16,13.77,21,16.77,13,21.77,16,13.77,21,16.77,13,21.77,16,13.77,21,16.77,13,21.77,16,13.77,21,16.77,13,21.77,16,13.77,21,16.77,13,21.77,16,16.77,20,16.77,23,20.77,16,23.77,20,16.77,23,20.77,16,23.77,20,16.77,23,20.77,16,23.77,20,16.77,23,20.77,16,23.77,20,16.77,23,20.77,16,23.77]],[[,1,6,,.03,.06,6.02,.04,.09,,18,,.03,.06,6.02,.04,18.05,,,,6.03,.06,18.02,.04,6.05,,13,,6.03,.06,18.02,.04,6.05,,2,,.03,.06,2.02,.04,.09,,14,,.03,.06,2.02,.04,14.05,,,,2.03,.06,14.02,.04,2.05,,9,,2.03,.06,14.02,.04,2.05,,],[1,-1,6,6.75,13,6.75,11,13.75,16,11.75,18,16.75,21,18.75,28,21.75,30,28.75,6,30.75,13,6.75,11,13.75,16,11.75,18,16.75,21,18.75,28,21.75,30,28.75,6,30.75,13,6.75,11,13.75,16,11.75,18,16.75,21,18.75,28,21.75,30,28.75,6,30.75,13,6.75,11,13.75,16,11.75,18,16.75,21,18.75,28,21.75,30,28.75]],[[,1,9,,.03,.06,9.02,.04,.09,,21,,.03,.06,9.02,.04,21.05,,,,9.03,.06,21.02,.04,9.05,,16,,9.03,.06,21.02,.04,9.05,,4,,.03,.06,4.02,.04,.09,,16,,.03,.06,4.02,.04,16.05,,,,4.03,.06,16.02,.04,4.05,,11,,4.03,.06,16.02,.04,4.05,,],[1,-1,4,4.75,9,4.75,9,9.75,16,9.75,16,16.75,21,16.75,21,21.75,28,21.75,4,28.75,9,4.75,9,9.75,16,9.75,16,16.75,21,16.75,21,21.75,28,21.75,11,28.75,16,11.75,16,16.75,23,16.75,23,23.75,28,23.75,28,28.75,35,28.75,11,28.75,16,11.75,16,16.75,23,16.75,23,23.75,28,23.75,28,28.75,35,28.75]],[[,1,6,,.03,.06,6.02,.04,.09,,18,,.03,.06,6.02,.04,18.05,,,,6.03,.06,18.02,.04,6.05,,13,,6.03,.06,18.02,.04,6.05,,2,,.03,.06,2.02,.04,.09,,14,,.03,.06,2.02,.04,14.05,,,,2.03,.06,14.02,.04,2.05,,9,,2.03,.06,14.02,.04,2.05,,],[1,-1,20,21,,,20,,18,,20,21,,,20,,18,,20.75,,21,,20,,18,,20,21,,,20,,18,,20,21,,,20,,18,,20,21,,,20,,18,,20.75,,21,,20,,18,,20,21,,,20,,18,,]],[[,1,9,,.03,.06,9.02,.04,.09,,21,,.03,.06,9.02,.04,21.05,,,,9.03,.06,21.02,.04,9.05,,16,,9.03,.06,21.02,.04,9.05,,4,,.03,.06,4.02,.04,.09,,16,,.03,.06,4.02,.04,16.05,,,,4.03,.06,16.02,.04,4.05,,11,,4.03,.06,16.02,.04,4.05,,],[1,-1,15,16,,,21,,25,,15,16,,,21,,25,,21.75,,16,,21,,25.16,.32,25,28,,,26,,25,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,]]],[0,1,0,1,2,3,4,5],180,{title:"sr",instruments:["2","5"],patterns:["2","3","4","5","6","7"]}];let Q={zoom:1.05,x:0,y:0,sx:0,sy:0,i:0,m:0,f:0,shake:async(t,e,i)=>{Q.m=t,Q.f=e,await N(i),Q.m=Q.f=Q.sy=Q.sx=0}},Z=document.getElementsByTagName("a")[0];Z.onclick=()=>{undefined.playbackRate.value="mute"===Z.innerHTML?0:1,Z.innerHTML="mute"===Z.innerHTML?"unmute":"mute",zzfxV=zzfxV?0:.3};zzfx=(...t)=>zzfxP(zzfxG(...t)),zzfxV=.3,zzfxR=44100,zzfxX=new AudioContext,zzfxP=(...t)=>{let e=zzfxX.createBuffer(t.length,t[0].length,44100),i=zzfxX.createBufferSource();return t.map(((t,i)=>e.getChannelData(i).set(t))),i.buffer=e,i.connect(zzfxX.destination),i.start(),i},zzfxG=(t=1,e=.05,i=220,n=0,s=0,o=.1,h=0,r=1,a=0,c=0,l=0,d=0,u=0,f=0,x=0,w=0,p=0,g=1,m=0,_=0,y=0)=>{let z,v,M=2*Math.PI,b=t=>t<0?-1:1,A=a*=500*M/44100/44100,C=i*=(1+2*e*Math.random()-e)*M/44100,P=[],R=0,S=0,E=0,k=1,B=0,T=0,D=0,L=M*Math.abs(y)*2/44100,O=Math.cos(L),j=Math.sin(L)/2/2,W=1+j,$=-2*O/W,H=(1-j)/W,N=(1+b(y)*O)/2/W,U=-(b(y)+O)/W,X=N,F=0,q=0,G=0,I=0;for(n=44100*n+9,m*=44100,s*=44100,o*=44100,p*=44100,c*=500*M/44100**3,x*=M/44100,l*=M/44100,d*=44100,u=44100*u|0,t*=zzfxV,v=n+m+s+o+p|0;E<v;P[E++]=D*t)++T%(100*w|0)||(D=h?h>1?h>2?h>3?Math.sin(R**3):Math.max(Math.min(Math.tan(R),1),-1):1-(2*R/M%2+2)%2:1-4*Math.abs(Math.round(R/M)-R/M):Math.sin(R),D=(u?1-_+_*Math.sin(M*E/u):1)*b(D)*Math.abs(D)**r*(E<n?E/n:E<n+m?1-(E-n)/m*(1-g):E<n+m+s?g:E<v-p?(v-E-p)/o*g:0),D=p?D/2+(p>E?0:(E<v-p?1:(v-E)/p)*P[E-p|0]/2/t):D,y&&(D=I=X*F+U*(F=q)+N*(q=D)-H*G-$*(G=I))),z=(i+=a+=c)*Math.cos(x*S++),R+=z+z*f*Math.sin(E**5),k&&++k>d&&(i+=l,C+=l,k=0),!u||++B%u||(i=C,a=A,k=k||1);return P},
//! ZzFXM (v2.0.3) | (C) Keith Clark | MIT | https://github.com/keithclark/ZzFXM
zzfxM=(t,e,i,n=125)=>{let s,o,h,r,a,c,l,d,u,f,x,w,p,g,m=0,_=[],y=[],z=[],v=0,M=0,b=1,A={},C=44100/n*60>>2;for(;b;v++)_=[b=d=w=0],i.map(((n,P)=>{for(l=e[n][v]||[0,0,0],b|=!!e[n][v],g=w+(e[n][0].length-2-!d)*C,p=P==i.length-1,o=2,r=w;o<l.length+p;d=++o){for(a=l[o],u=o==l.length+p-1&&p||f!=(l[0]||0)|a|0,h=0;h<C&&d;h++>C-99&&u?x+=(x<1)/99:0)c=(1-x)*_[m++]/2||0,y[r]=(y[r]||0)-c*M+c,z[r]=(z[r++]||0)+c*M+c;a&&(x=a%1,M=l[1]||0,(a|=0)&&(_=A[[f=l[m=0]||0,a]]=A[[f,a]]||(s=[...t[f]],s[2]*=2**((a-12)/12),a>0?zzfxG(...s):[])))}w=g}));return[y,z]};const{canvas:tt}=(n=document.querySelector("canvas"),s=n.getContext("2d")||new Proxy({},a),s.imageSmoothingEnabled=!1,r("init"),{canvas:n,context:s});!function({radius:t=5,canvas:e=c()}={}){let i=g.get(e);if(!i){let n=window.getComputedStyle(e);i={x:0,y:0,radius:t,touches:{length:0},canvas:e,_cf:[],_lf:[],_o:[],_oo:null,_s:n},g.set(e,i)}e.addEventListener("mousedown",_),e.addEventListener("touchstart",_),e.addEventListener("mouseup",y),e.addEventListener("touchend",y),e.addEventListener("touchcancel",y),e.addEventListener("blur",v),e.addEventListener("mousemove",z),e.addEventListener("touchmove",z),i._t||(i._t=!0,h("tick",(()=>{i._lf.length=0,i._cf.map((t=>{i._lf.push(t)})),i._cf.length=0})))}(),tt.width=400,tt.height=700;const et=(({canvas:e})=>{const i=(({canvas:e})=>{let i=1;const n={floor:new P(V),floor2:new P(["#463D33","#393127"]),ceiling:new P([...V].reverse()),puzzle:S(),leftDoor:new P(G),rightDoor:new P(G),topPanel2:new P([I.at(-1)]),leftPanel2:new P([...I].reverse()),rightPanel2:new P([...I].reverse()),leftPanel:new P(q),rightPanel:new P(q),topPanel:new P(["#55493E","#76685A"]),leftWall:new P([...Y].reverse()),rightWall:new P([...Y].reverse()),timer:F()},s=[];for(let t=0;t<15;t++)s.push(new X);const o=()=>{const t=e.height,o=e.width,h=220,r=460,a=h/3,c=(o-h-2*a)/2,l=(t-r)/2,d=h/45,u=2*-d,f=o-2*c,x=110-d,w=r-3*d,p=c/1.5,g=c+a+d,m=$(g-x,g,i),_=$(g+x+x,g+x,i);n.ceiling.onResize(0,0,o,106),n.floor.onResize(0,560,o,240),n.floor2.onResize(o/2-300,600,600,110,140,0,0),n.leftPanel.onResize(c,l,a,r),n.leftPanel2.onResize(c+a,l,d,r,0,u,0,0),n.rightPanel.onResize(o-c-a,l,a,r),n.rightPanel2.onResize(o-c-d-a,l,d,r,0,0,0,u),n.topPanel.onResize(c,l-a,f,a),n.topPanel2.onResize(c+a,l-a+a,h,Math.abs(u)),n.leftWall.onResize(0,l-a,c,r+a,0,0,0,p),n.rightWall.onResize(o-c,l-a,c,r+a,0,p,0,0),n.leftDoor.onResize(m,l+d+6,x,w-6),n.rightDoor.onResize(_,l+d+6,x,w-6);const y=o-c-a+7.5+(a-49)/2,z=l+230-17+8.5+1;n.timer.onResize(y-7.5,z-60,49,30),s.forEach(((t,e)=>{t.x=y+e%3*17,t.y=z+17*Math.floor(e/3)}))};return o(),{buttons:s,doorPosition:i,timer:n.timer,puzzle:n.puzzle,render(){[...Object.values(n),...s].forEach((t=>t.render()))},toggleButtons(t=!0){s.forEach((e=>{e.hovered=e.pressed=!1,e.disabled=!e.textNode.text||!t}))},updateButtons(t,e){s.forEach(((i,n)=>{i.disabled=!t[n],i.textNode.text=t[n]?`${t[n]}`:"",i.hasColorState="string"==typeof e,i.isCorrect="string"!=typeof e||t[n]===e}))},toggleDoor:(e=1,n=1e3)=>(n>0&&O("doors"),N(n,(n=>{i=t(.1,1,0===e?1-n:n),o()}))),update(){}}})({canvas:e}),n=new P(["#000"]);n.onResize(0,0,e.width,e.height);const s=l(),o=p({text:"Final\nLift",font:"84px Arial",x:e.width/2,y:.4*e.height}),r=p({text:"Press to start",font:"32px Arial",x:e.width/2,y:.85*e.height});let a=0,c=4,d=0,u=0,f=0,x=0;const w=async t=>{const e=Q.zoom,i=Q.x;await N(t.duration??500,(n=>{"number"==typeof t.zoom&&(Q.zoom=$(e,t.zoom,n)),"number"==typeof t.x&&(Q.x=$(i,t.x,n))})),"number"!=typeof t.x&&(Q.x=0)},g=async(t=0,e=1,i=1e3)=>{await N(i,(i=>{n.colors=[`#000000${J($(t,e,i))}`]}))},m=async(t,e=!1)=>{if(e)return u=t,i.timer.setText(`${u}`);const n=t>0?1:-1;for(;0!==t&&u>0;){t+=-1*n,u=Math.min(99,u+n),i.timer.setText(`${u}`);O(n<0&&u<10?"tickUrgent":"tick"),await N(100)}},_=async()=>{1!==c&&2!==c||(m(-1),u<=0&&(m(0,!0),g(.5,1),M())),await N(1e3),_()};_();const y=async(t=!0)=>{t?(await w({zoom:4.25,x:190,duration:500}),i.toggleButtons(!0)):(i.toggleButtons(!1),await w({zoom:2,x:0,duration:500}))},z=async(t=!1)=>{if(t?(await g(.75,.5),i.puzzle.nextPuzzle(x,a)):(i.updateButtons([]),i.toggleDoor(1),await w({zoom:1.05,x:0}),await N(500),i.puzzle.nextPuzzle(x,a)),await N(t?500:250),t||(O("elevator"),await Q.shake(2.75,4,1200),await N(500)),13===a&&i.puzzle.setText("13","#ff0000"),i.toggleDoor(0),await w({zoom:2,duration:1e3}),13===a)return await N(500),g(.5,1),M();f=0,i.updateButtons(i.puzzle.getOptions(),i.puzzle.getCorrectAnswer()[f]),c=1},v=async()=>{d+=1,m(5),C(),i.updateButtons(((t,e)=>{let i=[];const n=(e,i,n)=>t+e>=1&&t+e<=20&&n.indexOf(e)===i;for(;i.length<3;)i.push(H(t,e)),i=i.filter(n);return W(i.map((t=>`${t>0?"+":""}${t}`)))})(a,x)),await y(!0)},M=async()=>{3!==c&&(c=3,O("gameover"),await N(1e3),i.updateButtons([]),await w({zoom:1.05,x:0,duration:0}),await i.toggleDoor(1,0),await g(1,.75),r.text=`Score: ${d}`,b(0,1),c=4)},b=(t=1,e=0)=>N(1e3,(i=>{r.color=o.color=`#ffffff${J($(t,e,i))}`}));g(1,.75,0),h("press",(async t=>{if(1!==c&&2!==c)return;window.__disableClick=!0;const e=i.puzzle.getCorrectAnswer(),n=t===e[f],s=f===e.length-1;n||1!==c||(m(-3),Q.shake(7,1,250)),1===c?n&&(s?(c=2,await N(1e3),await v()):i.updateButtons(i.puzzle.getOptions(),e[++f])):(a+=+t,c=0,await z()),window.__disableClick=!1}));const C=()=>{x=Math.min(9,1+Math.floor(d/4)),D=1+(x-1)/9,i.timer.setDifficulty(x)};return A("up",(t=>{if(window.__pointerDown=!1,console.log(K.length),4===c&&(c=0,a=1,d=0,C(),m(60,!0),b(),z(!0),O("startGame")),1===c&&Q.zoom>=2){const i=(t.offsetX??t.changedTouches[0].clientX)/e.width;0===Q.x?(O("swap"),y(!0)):190===Q.x&&i<.2&&(O("swap"),y(!1))}})),A("down",(()=>{window.__pointerDown=!0})),{shutdown(){},update(){e.style.cursor=i.buttons.some((t=>t.hovered))?"pointer":"initial"},render(){s.save();const t=e.width/2,h=e.height/2;++Q.i%Q.f==0&&(Q.i=0,Q.sx=(1-2*Math.random())*Q.m,Q.sy=(1-2*Math.random())*Q.m),s.translate(t+Q.x+Q.sx,h+Q.y+Q.sy),s.scale(Q.zoom,Q.zoom),s.translate(-(t+Q.x),-(h+Q.y)),i.render(),n.render(),o.render(),r.render(),s.restore()}}})({canvas:tt});(function({fps:t=60,clearCanvas:i=!0,update:n=e,render:s,context:o=l(),blur:a=!1}={}){let c,d,u,f,x,w=0,p=1e3/t,g=1/t,m=i?C:e;function _(){if(d=requestAnimationFrame(_),window.__focused&&(u=performance.now(),f=u-c,c=u,!(f>1e3))){for(w+=f;w>=p;)r("tick"),x.update(g),w-=p;m(x.context),x.render()}}return window.__focused=!0,a||(window.addEventListener("focus",(()=>{window.__focused=!0})),window.addEventListener("blur",(()=>{window.__focused=!1}))),h("init",(()=>{x.context??=l()})),x={update:n,render:s,isStopped:!0,context:o,start(){this.isStopped&&(c=performance.now(),this.isStopped=!1,requestAnimationFrame(_))},stop(){this.isStopped=!0,cancelAnimationFrame(d)}},x})({update:()=>et.update(),render:()=>et.render()}).start();</script></body></html>